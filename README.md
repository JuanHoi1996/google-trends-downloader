# Google Trends Downloader (GUI Version)

一个用于批量下载 Google Trends 数据的图形界面工具，专为需要定期获取关键词搜索趋势数据的用户设计。

## ✨ 主要特性

- 🖥️ **图形界面操作** - 无需命令行，简单易用
- 📊 **批量下载** - 支持多个关键词同时下载
- 💾 **自动保存配置** - 关键词和参数自动保存，下次打开自动加载
- 📈 **实时进度显示** - 下载过程实时反馈
- 🔄 **智能重试机制** - 遇到限速自动重试，成功率高
- 📁 **自定义输出** - 可选择任意输出目录
- 🚀 **独立可执行文件** - 可打包成 `.exe`，无需安装 Python

## 📦 快速开始

### 方法一：使用可执行文件（推荐）

1. 下载 `GoogleTrendsDownloader.exe`
2. 双击运行
3. 设置关键词和参数
4. 点击"开始下载"

### 方法二：运行 Python 脚本

#### 环境要求

- Python 3.7+
- 依赖包：`pytrends`, `pandas`, `tkinter`

#### 安装依赖

```bash
pip install pytrends pandas
```

> 注意：`tkinter` 通常随 Python 一起安装，如果缺失请参考 [官方文档](https://docs.python.org/3/library/tkinter.html)

#### 运行程序

```bash
python google_trends_gui_no_warmup.py
```

## 📖 使用说明

### 1. 设置关键词

在左侧"关键词设置"区域，每行输入一个关键词：

```
MOLLY
CRYBABY
LABUBU
SKULLPANDA
```

### 2. 设置输出目录

点击"浏览"按钮选择保存 CSV 文件的目录。

### 3. 调整下载参数

- **关键词间等待时间**：建议 30-60 秒（成功率 95%+）
- **最大重试次数**：建议 3 次

### 4. 开始下载

点击"开始下载"按钮，程序会：
1. 逐个下载每个关键词的数据
2. 实时显示进度和日志
3. 完成后自动保存为 CSV 文件

### 5. 保存配置

点击"保存配置"按钮，下次打开程序会自动加载您的设置。

## 📊 数据说明

### 下载的数据

- **时间范围**：过去 5 年
- **地理位置**：全球 (Worldwide)
- **类别**：所有类别
- **搜索类型**：网页搜索

### 输出格式

CSV 文件，格式如下：

| date       | MOLLY | CRYBABY | LABUBU | ... |
|------------|-------|---------|--------|-----|
| 2019-12-01 | 44    | 32      | 15     | ... |
| 2019-12-08 | 46    | 35      | 16     | ... |
| ...        | ...   | ...     | ...    | ... |

> 注意：数值是相对热度，范围 0-100，100 表示该关键词在该时间段内的峰值热度。

## ⚙️ 技术原理

### v1.4.2 版本特性

本版本采用**无预热模式**，核心特点：

1. **独立会话**：每个关键词使用全新的 `TrendReq` 会话
2. **无预热**：不进行预热查询，避免会话污染
3. **数据准确**：经测试验证，数据与 Google Trends 官网一致

### 为什么不预热？

经过大量测试发现，预热查询会"污染"会话状态，导致后续查询返回的数据不准确。无预热模式虽然可能遇到更多限速，但通过合理的等待时间（30-60秒）可以达到 95%+ 的成功率。

### 限速处理

- **指数退避**：重试时等待时间逐次增加（30s → 60s → 120s）
- **随机抖动**：避免与其他请求冲突
- **会话重建**：每次重试都创建新会话

## 🛠️ 打包成可执行文件

### 使用 PyInstaller

#### 安装 PyInstaller

```bash
pip install pyinstaller
```

#### 快速打包（推荐）

**Windows 用户**：

双击运行 `一键打包.bat`

或者在命令行中：

```bash
.\一键打包.bat
```

#### 手动打包

```bash
python -m PyInstaller --onefile --windowed --name GoogleTrendsDownloader google_trends_gui_no_warmup.py
```

打包完成后，可执行文件位于 `dist/GoogleTrendsDownloader.exe`

## 📝 常见问题

### 1. 下载失败，提示 429 错误

**原因**：Google Trends API 限速

**解决方案**：
- 增加等待时间（建议 40-80 秒）
- 减少关键词数量
- 稍后再试

### 2. 数据与官网不一致

**原因**：可能使用了旧版本（带预热的版本）

**解决方案**：
- 确保使用 v1.4.2 无预热版本
- 每个关键词使用独立会话

### 3. SSL 连接错误

**原因**：网络或 SSL 证书问题

**解决方案**：
- 检查网络连接
- 尝试使用 VPN
- 更新 Python 和依赖包

### 4. 打包后的 exe 无法运行

**原因**：可能被杀毒软件拦截

**解决方案**：
- 添加到杀毒软件白名单
- 使用 `--windowed` 参数打包

## 📜 版本历史

### v1.4.2 (2024-11-24)
- ✨ 优化界面布局：左右分栏（配置区 | 日志区）
- 🔒 修复输出目录初始化：始终使用当前工作目录
- 🎨 优化控件布局和间距

### v1.4.1 (2024-11-19)
- 🐛 修复重试计数显示问题

### v1.4.0 (2024-11-10)
- 🚀 移除预热流程（最终修复数据准确性问题）
- ✨ 每个关键词使用独立会话
- 📊 经测试验证数据准确性

### v1.3.0 (2024-10-27)
- 🎨 添加图形界面
- 💾 配置自动保存/加载
- 📊 实时进度显示

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

## 🙏 致谢

- [pytrends](https://github.com/GeneralMills/pytrends) - Google Trends API 封装
- [pandas](https://pandas.pydata.org/) - 数据处理
- [tkinter](https://docs.python.org/3/library/tkinter.html) - GUI 框架

## 📧 联系方式

如有问题或建议，欢迎通过 GitHub Issues 联系。

---

**⭐ 如果这个项目对您有帮助，请给个 Star！**

